# æ­¡è¿è¨æ¯
welcome.message=ä¸­ææ¸¬è©¦

# Spring MVC è¦åéç½®
# spring.mvc.view.prefix=/WEB-INF/views/
# spring.mvc.view.suffix=.jsp

# ================================================================
#                    Session è¶æç®¡çéç½® (Session Timeout Management)
# ================================================================

# Session è¶ææéè¨­å® (å®ä½: ç§)
# è¨­å®çº 1800 ç§ (30åé)ï¼ç¬¦åä¸è¬å¾å°ç®¡çç³»çµ±çå®å¨è¦æ±
server.servlet.session.timeout=1800s

# Session Cookie éç½®
server.servlet.session.cookie.name=EATFAST_SESSION
server.servlet.session.cookie.max-age=1800
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict

# Session è¿½è¹¤æ¨¡å¼ (æ¨è¦åªä½¿ç¨ Cookie)
server.servlet.session.tracking-modes=cookie

# Session æä¹åéç½® (å¦æä½¿ç¨ Redis ä½çº Session å­å²)
# spring.session.store-type=redis
# spring.session.redis.flush-mode=on_save
# spring.session.redis.namespace=eatfast:session

# éç¼æ¨¡å¼ä¸ç Session éç½®
spring.session.timeout=1800s

# è³æåº«é£æ¥éç½® - MySQL
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.url=jdbc:mysql://localhost:3306/eatfast_db?serverTimezone=Asia/Taipei&characterEncoding=utf-8&useSSL=false&allowPublicKeyRetrieval=true&autoReconnect=true&failOverReadOnly=false&maxReconnects=10&createDatabaseIfNotExist=true&useUnicode=true
spring.datasource.username=root
spring.datasource.password=${DB_PASSWORD:123456}

# HikariCP é£æ¥æ± éç½® - éä½è¶ææéä»¥å¿«éå¤±æ
spring.datasource.hikari.connection-timeout=10000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.initialization-fail-timeout=1
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.leak-detection-threshold=60000

# Docker ç°å¢ç¹æ®éç½®
spring.datasource.hikari.data-source-properties.socketTimeout=30000
spring.datasource.hikari.data-source-properties.connectTimeout=10000
spring.datasource.hikari.data-source-properties.useSSL=false
spring.datasource.hikari.data-source-properties.allowPublicKeyRetrieval=true

# JPAéç½® - æ¹çº validate é¿åéå»ºè¡¨æ ¼
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.highlight_sql=true
spring.jpa.defer-datasource-initialization=true

# æ·»å æ¸æåº«åå§åéç½®
spring.sql.init.mode=embedded
spring.sql.init.continue-on-error=true

# æ¥èªéç½®
logging.level.com.zaxxer.hikari=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.com.mysql.cj.jdbc=DEBUG

# ãæ°å¢ãå¡ï¿½?æ¨¡çµå°ç¨æ¥èªéç½®
logging.level.com.eatfast.employee=DEBUG
logging.level.com.eatfast.employee.service=DEBUG
logging.level.com.eatfast.employee.controller=DEBUG
logging.level.com.eatfast.employee.repository=DEBUG

# ãæ°å¢ãå®å¨ç¸éæ¥èªéç½®
logging.level.org.springframework.security=DEBUG

# ãæ°å¢ãæ ¹æç°å¢èª¿æ´æ¥èªç´å¥
spring.profiles.active=dev

# æ§è½ç£æ§éç½®
spring.jpa.properties.hibernate.generate_statistics=true
spring.jpa.properties.hibernate.session.events.log.LOG_QUERIES_SLOWER_THAN_MS=1000

# éç¼æ¨¡å¼éç½® - ééå¿«å
spring.thymeleaf.cache=false
spring.web.resources.cache.period=0

# æªæ¡ä¸å³éç½®
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
app.upload.employee-photos=uploads/employee-photos
app.upload.meal-pic=uploads/meal_pic
app.meal-photo-batch.enabled=true
app.meal-photo-folder=src/main/resources/static/images/meal_pic
app.meal-photo-batch.flag-file-path=uploads/photo-batch-done.flag

# ================================================================
#                    Redis éç½® (Redis Configuration)
# ================================================================

# Redis ä¼ºæå¨éç½®
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.database=0

# Redis é£æ¥æ± éç½® (Lettuce)
spring.data.redis.lettuce.pool.max-active=10
spring.data.redis.lettuce.pool.max-idle=10
spring.data.redis.lettuce.pool.min-idle=1
spring.data.redis.lettuce.pool.max-wait=-1ms

# Redis é£æ¥è¶æéç½®
spring.data.redis.timeout=3000ms
spring.data.redis.lettuce.shutdown-timeout=200ms

# Redis åºååéç½®
spring.data.redis.jedis.pool.enabled=true

# ================================================================
#                    éµä»¶æåéç½® (Mail Configuration)
# ================================================================

# Gmail SMTP éç½® 
spring.mail.host=smtp.gmail.com
spring.mail.port=465
spring.mail.username=ghao2786@gmail.com
spring.mail.password=xafbhgsukkwizsnb

# SMTP å±¬æ§éç½®
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=false
spring.mail.properties.mail.smtp.ssl.enable=true
spring.mail.properties.mail.smtp.ssl.required=true
spring.mail.properties.mail.smtp.socketFactory.port=465
spring.mail.properties.mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory
spring.mail.properties.mail.smtp.socketFactory.fallback=false

# ãééä¿®æ­£ãéµä»¶ç·¨ç¢¼åè¶æè¨­å® - é²æ­¢ä¸­æäºç¢¼
spring.mail.default-encoding=UTF-8
spring.mail.properties.mail.mime.charset=UTF-8
spring.mail.properties.mail.smtp.timeout=25000
spring.mail.properties.mail.smtp.connectiontimeout=25000
spring.mail.properties.mail.smtp.writetimeout=25000

# ãæ°å¢ãå¼·å¶ä½¿ç¨ UTF-8 ç·¨ç¢¼çé¡å¤è¨­å®
spring.mail.properties.mail.mime.multipart.allowempty=true
spring.mail.properties.mail.mime.multipart.ignoreexistingboundaryparameter=true
spring.mail.javamail.default-encoding=UTF-8

# æç¨ç¨å¼éµä»¶éç½®
app.mail.system-name=æ©é¤åºç®¡çç³»çµ±
app.mail.enabled=true

# ä¼ºæå¨éç½®
server.port=8080
# server.servlet.context-path=/eatfast

# ================================================================
#                    é©è­ç¢¼å­å²éç½® (Verification Code Storage)
# ================================================================

# ç¶ Redis ä¸å¯ç¨æï¼ä½¿ç¨å§å­å­å²é©è­ç¢¼
# å¯é¸å¼: redis, memory
verification.storage.type=memory


file.upload-dir=src/main/resources/static


# ================================================================
#     Google API Key (Google API Key Configuration)
# ================================================================


google.maps.api.key=AIzaSyB36pLOxEmnvBRe4fi6v5QWGJ1WusayILg

# ================================================================
#                    JVM 穩定性配置 (JVM Stability Configuration)
# ================================================================

# JVM 記憶體配置 - 避免記憶體不足導致的崩潰
spring.jvm.memory.initial=-Xms512m
spring.jvm.memory.maximum=-Xmx2g
spring.jvm.memory.metaspace=-XX:MetaspaceSize=256m -XX:MaxMetaspaceSize=512m

# JVM 編譯器穩定性配置
spring.jvm.compiler.tiered-compilation=-XX:+TieredCompilation
spring.jvm.compiler.compilation-threshold=-XX:CompileThreshold=10000
spring.jvm.compiler.disable-background-compilation=-XX:-BackgroundCompilation

# GC 配置 - 使用 G1GC 提供更好的穩定性
spring.jvm.gc.collector=-XX:+UseG1GC
spring.jvm.gc.max-pause=-XX:MaxGCPauseMillis=200
spring.jvm.gc.heap-region=-XX:G1HeapRegionSize=16m

# 安全和穩定性配置
spring.jvm.security.exit-on-error=-XX:+ExitOnOutOfMemoryError
spring.jvm.security.crash-dumps=-XX:+HeapDumpOnOutOfMemoryError
spring.jvm.security.dump-path=-XX:HeapDumpPath=./dumps/

# 編譯器安全配置
spring.jvm.compiler.inline-size=-XX:MaxInlineSize=35
spring.jvm.compiler.frequent-inline=-XX:FreqInlineSize=325